# OrganicChem-AI

> **在北京大学校园网环境下/校外师生连接了北大内网VPN时，如仅想快速体验，无需部署即可直接访问：**
>
> **[http://10.129.241.15:5173/](http://10.129.241.15:5173/)**
>
> 若访问或使用异常，可参考以下内容进行本地部署或调试

## 一、运行环境

> 运行时请开启国外代理，否则部分功能将无法使用

**Node.js 20.19.5**

* 前往 [Node.js 官网](https://nodejs.org/) 下载并安装 **Node.js 20.19.5**。
* 或直接下载压缩包：[Node.js v20.19.5](https://nodejs.org/dist/v20.19.5/)，解压后将 `node.exe` 所在文件夹的路径添加到系统环境变量中。

**.env 文件**

* **首次运行前必须配置 `.env` 文件**：复制 `.env.example` 为 `.env`，并根据注释填写必需的配置项（API密钥、邮箱等）。

* 若需要可供直接使用 `.env` 文件，请私下联系本作者。

**数据库文件**

* 由于数据库文件过大无法上传至Github，请在 [北大网盘](https://disk.pku.edu.cn/link/AA53BE8BB4F83E488F8896910B2368FB84) 中下载 `memory.db` ，并将其放入主目录文件夹中。

---

## 二、电脑端运行方式

1. 下载并解压项目文件夹，使用 **VS Code** 打开项目根目录。
2. 在终端运行以下命令安装依赖：

   ```bash
   npm install
   ```
3. 修改 `.env` 文件，确保：

   ```bash
   VITE_API_BASE=http://localhost:3001
   ```
4. 启动前端：

   ```bash
   npm run dev
   ```
5. 新建一个终端窗口（仍在项目根目录），启动后端服务：

   ```bash
   node server.js
   ```
6. 在电脑浏览器打开并访问：

   ```bash
   http://localhost:5173/
   ```

   **建议使用 Chrome 或 Edge 浏览器**，以支持语音输入功能。

---

## 三、移动端运行方式

> **移动端访问说明**
>
> 默认情况下，移动端访问需确保移动端设备与电脑处于同一局域网，且该局域网未设置端与端隔离（如北京大学校园网由于设有端与端隔离，默认方式无法使用）。
>
> 若仅为测试或本地使用，可在手机上开启热点，并让电脑连接该热点，即可正常访问。
>
> **若希望在不同网络下访问**，可参照 [https://github.com/doralyyyyy/QChat](https://github.com/doralyyyyy/QChat) 中的网络配置方案修改接口设置，或私下联系作者。

1. 在电脑端（**VS Code**）打开项目根目录的终端，先用 `--host` 启动前端以便显示 Network 地址：

   ```bash
   npm run dev -- --host
   ```
2. 在终端输出里找到 **Network** 后面的链接（示例）：

   ```bash
   http://192.168.1.10:5173/
   ```
3. 将该 IP 替换进项目根目录的 `.env`，**但端口改为后端端口 `3001`，并删掉末尾斜杠**，例如：

   ```bash
   VITE_API_BASE=http://192.168.1.10:3001
   ```
4. 修改完 `.env` 后，重启前端（停止后重新运行）：

   ```bash
   npm run dev -- --host
   ```
5. 在一个新建终端窗口启动后端服务：

   ```bash
   node server.js
   ```
6. 在移动端浏览器中访问前面终端给出的 **Network 链接**（示例）：

   ```bash
   http://192.168.1.10:5173/
   ```

---

## 四、注意事项

### 1. 软件版本要求

* **Node.js**：必须使用 **20.19.5** 版本，不要使用最新版本或其他版本，否则可能出现兼容性问题。

### 2. 开发环境与运行

* 推荐使用 **VS Code** 作为开发和使用环境以便同时打开多个终端和查看输出。
* 前端与后端需同时运行（前端读取 `.env` 中的 `VITE_API_BASE` 以连接后端）。
* 修改 `.env` 后需要重启前端（`npm run dev`），否则变更不会生效。

### 3. 网络与设备

* 移动端访问电脑的 Network 链接时，**移动端与电脑须连接同一局域网**（也可使用内网穿透工具建立连接），并确保电脑防火墙允许 5173/3001 端口的局域网访问。
* **平板电脑 / iPad 请使用横屏浏览**。

### 4. 浏览器与语音输入

* 电脑端建议使用 **Chrome** 或 **Edge** 浏览器，其他浏览器可能无法使用语音输入功能。
* 由于移动端浏览器限制（HTTP 协议权限较低），移动端部分机型（如华为）可能无法使用语音输入功能；对于支持的系统（如iOS等），请确保已为浏览器及端口开启 **录音权限**，并开启类似 **“智能语音输入”** 的功能，即可正常使用语音输入。
* 若出现“network”报错，表明未成功与境外服务器连接，需开启国外代理。
* 若出现“not-allowed”报错，表明浏览器未对该网址开启麦克风权限。
